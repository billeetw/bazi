# ğŸš€ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæŒ‡å—

## âš ï¸ å½“å‰é—®é¢˜

ç”Ÿäº§ç¯å¢ƒ `www.17gonplay.com` è¿˜åœ¨ä½¿ç”¨æ—§ç‰ˆæœ¬çš„ä»£ç ï¼ˆ`?v=1` å’Œ `?v=2`ï¼‰ï¼Œå¯¼è‡´ JavaScript é”™è¯¯ã€‚

## âœ… å·²ä¿®å¤çš„é—®é¢˜

1. âœ… `baziCore.js` - ä¿®å¤äº†è§£æ„èµ‹å€¼è¯­æ³•é”™è¯¯
2. âœ… `fourTransformations.js` - ä¿®å¤äº†ä¾èµ–æ£€æŸ¥é€»è¾‘
3. âœ… `overlapAnalysis.js` - ä¿®å¤äº†ä¾èµ–æ£€æŸ¥é€»è¾‘
4. âœ… `calc.js` - ç§»é™¤äº† `mingBranch` çš„å†—ä½™èµ‹å€¼
5. âœ… `ui.js` - æ·»åŠ äº† `window.Calc` æœªå®šä¹‰æ—¶çš„å¤„ç†
6. âœ… æ‰€æœ‰ç‰ˆæœ¬å·å·²æ›´æ–°åˆ° `?v=3`

## ğŸ“‹ éƒ¨ç½²æ­¥éª¤

### æ–¹æ³• 1ï¼šä½¿ç”¨ Git è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰

å¦‚æœé¡¹ç›®å·²è¿æ¥åˆ° Cloudflare Pages çš„ Git é›†æˆï¼š

```bash
# 1. æ£€æŸ¥å½“å‰çŠ¶æ€
git status

# 2. æ·»åŠ æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶
git add .

# 3. æäº¤æ›´æ”¹
git commit -m "ä¿®å¤ JavaScript è¯­æ³•é”™è¯¯å’Œä¾èµ–åŠ è½½é—®é¢˜"

# 4. æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push origin main
# æˆ–
git push origin master
```

Cloudflare Pages ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æ¨é€å¹¶å¼€å§‹éƒ¨ç½²ã€‚

### æ–¹æ³• 2ï¼šä½¿ç”¨ Wrangler æ‰‹åŠ¨éƒ¨ç½²

```bash
# 1. ç¡®ä¿å·²ç™»å½• Cloudflare
npx wrangler login

# 2. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
npx wrangler pages deploy . --project-name=bazi
```

### æ–¹æ³• 3ï¼šé€šè¿‡ Cloudflare Dashboard

1. è®¿é—®ï¼šhttps://dash.cloudflare.com/
2. é€‰æ‹©ä½ çš„ Pages é¡¹ç›®
3. ç‚¹å‡»ã€ŒUpload assetsã€
4. ä¸Šä¼ æ•´ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹ï¼ˆæˆ–ä½¿ç”¨ Git é›†æˆï¼‰

## ğŸ” éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

### 1. ç¡®è®¤æ‰€æœ‰ä¿®å¤å·²ä¿å­˜

```bash
# æ£€æŸ¥å…³é”®æ–‡ä»¶çš„ç‰ˆæœ¬å·
grep "baziCore.js?v=" index.html
# åº”è¯¥æ˜¾ç¤ºï¼šbaziCore.js?v=3

grep "fourTransformations.js?v=" index.html
# åº”è¯¥æ˜¾ç¤ºï¼šfourTransformations.js?v=3

grep "calc.js?v=" index.html
# åº”è¯¥æ˜¾ç¤ºï¼šcalc.js?v=3

grep "ui.js?v=" index.html
# åº”è¯¥æ˜¾ç¤ºï¼šui.js?v=3
```

### 2. ç¡®è®¤æ–‡ä»¶è¯­æ³•æ­£ç¡®

```bash
# æ£€æŸ¥è¯­æ³•
node -c js/calc/baziCore.js
node -c js/calc/fourTransformations.js
node -c js/calc/overlapAnalysis.js
node -c js/calc.js
node -c js/ui.js
```

### 3. ç¡®è®¤ç¯å¢ƒå˜é‡å·²è®¾ç½®

åœ¨ Cloudflare Dashboard ä¸­æ£€æŸ¥ï¼š
- `ADMIN_USER`
- `ADMIN_PASSWORD`
- `GOOGLE_CLIENT_ID`
- `GOOGLE_CLIENT_SECRET`
- `FACEBOOK_APP_ID`
- `FACEBOOK_APP_SECRET`
- `JWT_SECRET`

## ğŸ§ª éƒ¨ç½²åéªŒè¯

### 1. æ£€æŸ¥ç‰ˆæœ¬å·

è®¿é—® `https://www.17gonplay.com/index.html`ï¼Œæ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼š

1. åˆ‡æ¢åˆ°ã€ŒNetworkã€æ ‡ç­¾
2. åˆ·æ–°é¡µé¢
3. æ£€æŸ¥æ‰€æœ‰ JavaScript æ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼š
   - âœ… `baziCore.js?v=3`
   - âœ… `fourTransformations.js?v=3`
   - âœ… `overlapAnalysis.js?v=3`
   - âœ… `calc.js?v=3`
   - âœ… `ui.js?v=3`

### 2. æ£€æŸ¥æ§åˆ¶å°é”™è¯¯

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œç¡®è®¤ï¼š
- âœ… æ²¡æœ‰ `SyntaxError: Unexpected token '{'`
- âœ… æ²¡æœ‰ `Identifier 'mingBranch' has already been declared`
- âœ… æ²¡æœ‰ `Cannot destructure property 'PALACE_DEFAULT'`
- âœ… æ²¡æœ‰ä¾èµ–åŠ è½½é”™è¯¯

### 3. æµ‹è¯•åŠŸèƒ½

1. è¾“å…¥å‡ºç”Ÿä¿¡æ¯
2. ç‚¹å‡»ã€Œå•Ÿå‹•äººç”Ÿæˆ°ç•¥å¼•æ“ã€
3. ç¡®è®¤è®¡ç®—æ­£å¸¸
4. ç¡®è®¤ UI æ­£å¸¸æ˜¾ç¤º

## ğŸ› å¦‚æœéƒ¨ç½²åä»æœ‰é—®é¢˜

### é—®é¢˜ 1ï¼šç‰ˆæœ¬å·è¿˜æ˜¯æ—§çš„

**åŸå› **ï¼šæµè§ˆå™¨ç¼“å­˜  
**è§£å†³**ï¼š
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆ`Ctrl+Shift+Delete`ï¼‰
2. ç¡¬åˆ·æ–°é¡µé¢ï¼ˆ`Ctrl+F5`ï¼‰
3. æˆ–ä½¿ç”¨æ— ç—•æ¨¡å¼æµ‹è¯•

### é—®é¢˜ 2ï¼šéƒ¨ç½²å¤±è´¥

**æ£€æŸ¥**ï¼š
1. æŸ¥çœ‹ Cloudflare Dashboard ä¸­çš„éƒ¨ç½²æ—¥å¿—
2. ç¡®è®¤æ‰€æœ‰æ–‡ä»¶éƒ½å·²ä¸Šä¼ 
3. æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®

### é—®é¢˜ 3ï¼šAPI è·¯ç”±ä¸å·¥ä½œ

**æ£€æŸ¥**ï¼š
1. ç¡®è®¤ `functions/` æ–‡ä»¶å¤¹å·²éƒ¨ç½²
2. æ£€æŸ¥ Cloudflare Pages Functions æ˜¯å¦å¯ç”¨
3. æŸ¥çœ‹ Functions æ—¥å¿—

## ğŸ“ å¿«é€Ÿéƒ¨ç½²å‘½ä»¤

åˆ›å»ºä¸€ä¸ª `deploy.sh` è„šæœ¬ï¼š

```bash
#!/bin/bash
echo "ğŸš€ å¼€å§‹éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ..."
echo ""

# æ£€æŸ¥ Git çŠ¶æ€
if [ -n "$(git status --porcelain)" ]; then
    echo "âš ï¸  æœ‰æœªæäº¤çš„æ›´æ”¹"
    read -p "æ˜¯å¦ç»§ç»­éƒ¨ç½²ï¼Ÿ(y/n) " -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        exit 1
    fi
fi

# æ£€æŸ¥è¯­æ³•
echo "ğŸ” æ£€æŸ¥è¯­æ³•..."
node -c js/calc/baziCore.js && \
node -c js/calc/fourTransformations.js && \
node -c js/calc/overlapAnalysis.js && \
node -c js/calc.js && \
node -c js/ui.js && \
echo "âœ… è¯­æ³•æ£€æŸ¥é€šè¿‡" || {
    echo "âŒ è¯­æ³•æ£€æŸ¥å¤±è´¥"
    exit 1
}

# éƒ¨ç½²
echo "ğŸ“¦ éƒ¨ç½²åˆ° Cloudflare Pages..."
npx wrangler pages deploy . --project-name=bazi

echo ""
echo "âœ… éƒ¨ç½²å®Œæˆï¼"
echo "ğŸŒ è®¿é—®ï¼šhttps://www.17gonplay.com"
```

## ğŸ¯ æ€»ç»“

**å¿…é¡»éƒ¨ç½²çš„åŸå› **ï¼š
- ç”Ÿäº§ç¯å¢ƒè¿˜åœ¨ä½¿ç”¨æ—§ä»£ç ï¼ˆ`?v=1`ï¼‰
- æ‰€æœ‰ä¿®å¤éƒ½åœ¨æœ¬åœ°ï¼Œéœ€è¦æ¨é€åˆ°ç”Ÿäº§ç¯å¢ƒ

**æ¨èæ–¹æ³•**ï¼š
1. ä½¿ç”¨ Git è‡ªåŠ¨éƒ¨ç½²ï¼ˆå¦‚æœå·²é…ç½®ï¼‰
2. æˆ–ä½¿ç”¨ `wrangler pages deploy` æ‰‹åŠ¨éƒ¨ç½²

**éƒ¨ç½²å**ï¼š
- æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
- ç¡¬åˆ·æ–°é¡µé¢
- éªŒè¯ç‰ˆæœ¬å·å’ŒåŠŸèƒ½
