<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ä¸€èµ·å‡ºä¾†ç© Â· 2026 æˆ°ç•¥å°èˆª</title>

  <!-- Tailwind CDNï¼ˆé–‹ç™¼ç”¨ï¼Œä¹‹å¾Œè¦ä¸Šæ­£å¼ç‰ˆå¯ä»¥å†æ”¹ CLIï¼‰ -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%, #000 100%);
      color: #e2e8f0;
      font-family: system-ui,-apple-system,BlinkMacSystemFont,"Noto Sans TC",sans-serif;
    }
    .glass {
      background: rgba(15,23,42,0.9);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(148,163,184,0.35);
      border-radius: 1.25rem;
    }
    .bazi-char {
      font-size: 1.8rem;
      font-weight: 900;
      line-height: 1.1;
    }
    .wuxing-æœ¨{background:#22c55e}
    .wuxing-ç«{background:#ef4444}
    .wuxing-åœŸ{background:#eab308}
    .wuxing-é‡‘{background:#e5e7eb}
    .wuxing-æ°´{background:#3b82f6}

    /* ====== Nav Bar ====== */
    .nav-bar {
      background: linear-gradient(90deg, #ef4444, #f97316, #ef4444);
      color: #fff;
      padding: 10px 16px;
      position: sticky;
      top: 0;
      z-index: 40;
      box-shadow: 0 4px 20px rgba(220,38,38,0.6);
    }
    .nav-bar-title {
      font-weight: 900;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      font-size: 11px;
      color: #fee2e2;
    }

    /* ====== ç´«å¾® 12å®®æ ¼æ¨£å¼ ====== */
    .zw-grid-container {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(4, 1fr);
      gap: 8px;
      width: 100%;
      max-width: 520px;
      aspect-ratio: 1/1;
      margin: 0 auto;
    }
    .zw-palace {
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.35);
      border-radius: 0.85rem;
      padding: 8px;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
      transition: transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .zw-palace:hover {
      transform: translateY(-2px);
      border-color: rgba(248,250,252,0.8);
      box-shadow: 0 10px 30px rgba(15,23,42,0.7);
    }
    .zw-palace::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 150%;
      height: 150%;
      transform: translate(-50%, -50%);
      opacity: 0;
      transition: opacity 0.5s ease;
      z-index: -1;
      pointer-events: none;
    }
    [class*="palace-glow-"]::before { opacity: 1; }
    .palace-glow-æœ¨::before {
      background: radial-gradient(circle, rgba(34,197,94,0.18) 0%, transparent 70%);
    }
    .palace-glow-ç«::before {
      background: radial-gradient(circle, rgba(239,68,68,0.20) 0%, transparent 70%);
    }
    .palace-glow-åœŸ::before {
      background: radial-gradient(circle, rgba(234,179,8,0.20) 0%, transparent 70%);
    }
    .palace-glow-é‡‘::before {
      background: radial-gradient(circle, rgba(248,250,252,0.18) 0%, transparent 70%);
    }
    .palace-glow-æ°´::before {
      background: radial-gradient(circle, rgba(59,130,246,0.20) 0%, transparent 70%);
    }
    .zw-palace-key {
      border-color: rgba(251, 191, 36, 0.8);
      box-shadow: inset 0 0 16px rgba(251, 191, 36, 0.25);
    }
    .zw-center-block {
      grid-area: 2 / 2 / 4 / 4;
      background: radial-gradient(circle, #1e293b 35%, #020617 100%);
      border: 1px dashed rgba(148, 163, 184, 0.5);
      border-radius: 1.1rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 12px;
      z-index: 10;
    }
    .zw-center-block-badge {
      font-size: 10px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #64748b;
    }

    /* æ˜Ÿæ›œæ–‡å­—äº”è¡Œè‰² */
    .star-wx-æœ¨ { color: #86efac; text-shadow: 0 0 5px rgba(34,197,94,0.5); }
    .star-wx-ç« { color: #fca5a5; text-shadow: 0 0 5px rgba(239,68,68,0.5); }
    .star-wx-åœŸ { color: #fde047; text-shadow: 0 0 5px rgba(234,179,8,0.5); }
    .star-wx-é‡‘ { color: #e2e8f0; text-shadow: 0 0 5px rgba(255,255,255,0.5); }
    .star-wx-æ°´ { color: #93c5fd; text-shadow: 0 0 5px rgba(59,130,246,0.5); }
  </style>
</head>

<body class="min-h-screen">

  <!-- å°èˆªåˆ— -->
  <div class="nav-bar">
    <div class="max-w-4xl mx-auto flex items-center justify-between">
      <div>
        <div class="nav-bar-title">YIQICHULA I PLAY Â· 2026 STRATEGIC MAP</div>
        <div class="text-sm font-bold">ä¸€èµ·å‡ºä¾†ç© Â· 2026 æˆ°ç•¥å°èˆª</div>
      </div>
      <a href="#consult" class="text-xs underline underline-offset-4">é ç´„è«®è©¢</a>
    </div>
  </div>

  <main class="max-w-4xl mx-auto p-4 md:p-8 space-y-8">

    <!-- æ¨™é¡Œå€ -->
    <section class="space-y-2">
      <h1 class="text-3xl md:text-4xl font-black tracking-tight">ä½ çš„ 2026 ç”Ÿå­˜æˆ°ç•¥åœ°åœ–</h1>
      <p class="text-slate-400 text-sm">
        é€™ä¸æ˜¯ç®—å‘½ï¼Œæ˜¯æŠŠä½ çš„å…«å­— + ç´«å¾®å‘½ç›¤è®Šæˆï¼šäº”è¡Œèƒ½é‡å„€è¡¨æ¿ã€æµæœˆç´…ç¶ ç‡ˆã€èˆ‡äººç”Ÿç¯€å¥å»ºè­°ã€‚
      </p>
    </section>

    <!-- è¼¸å…¥å€ -->
    <section class="glass p-6 md:p-7 space-y-4">
      <h2 class="text-sm font-bold text-slate-300 tracking-[0.2em] uppercase">
        Step 1 Â· å¡«å…¥ä½ çš„å‡ºç”Ÿæ™‚é–“
      </h2>

      <div class="grid grid-cols-3 gap-2">
        <select id="birthYear" class="bg-slate-900/70 border border-slate-700 rounded-xl px-3 py-2 text-sm"></select>
        <select id="birthMonth" class="bg-slate-900/70 border border-slate-700 rounded-xl px-3 py-2 text-sm"></select>
        <select id="birthDay" class="bg-slate-900/70 border border-slate-700 rounded-xl px-3 py-2 text-sm"></select>
      </div>

      <div class="grid grid-cols-2 gap-2">
        <select id="birthHour" class="bg-slate-900/70 border border-slate-700 rounded-xl px-3 py-2 text-sm"></select>
        <select id="birthMinute" class="bg-slate-900/70 border border-slate-700 rounded-xl px-3 py-2 text-sm"></select>
      </div>

      <button
        class="w-full mt-2 bg-gradient-to-r from-amber-400 to-yellow-500 text-slate-950 py-3 rounded-xl font-black tracking-widest text-sm hover:brightness-110 active:scale-[0.99] transition"
        onclick="calculate()"
      >
        ç”Ÿæˆæˆ‘çš„ 2026 æˆ°ç•¥
      </button>

      <p id="hint" class="text-xs text-slate-500 italic"></p>
    </section>

    <!-- å ±å‘Šå€ -->
    <section id="report" class="space-y-8 hidden">

      <!-- å…«å­— + äº”è¡Œ -->
      <div class="grid md:grid-cols-[1.1fr,1.1fr] gap-6">
        <!-- å››æŸ± -->
        <div class="glass p-6 space-y-4">
          <h3 class="text-sm font-bold text-slate-300 tracking-[0.25em] uppercase">
            å…«å­— Â· æ²³åœ–æ™‚ç©ºåº§æ¨™
          </h3>
          <div class="grid grid-cols-4 text-center gap-2">
            <div>
              <div class="text-[10px] text-slate-500 mb-1">å¹´</div>
              <div id="yG" class="bazi-char"></div>
              <div id="yZ" class="text-sm text-slate-300"></div>
            </div>
            <div>
              <div class="text-[10px] text-slate-500 mb-1">æœˆ</div>
              <div id="mG" class="bazi-char"></div>
              <div id="mZ" class="text-sm text-slate-300"></div>
            </div>
            <div>
              <div class="text-[10px] text-amber-400 mb-1">æ—¥</div>
              <div id="dG" class="bazi-char text-amber-400"></div>
              <div id="dZ" class="text-sm text-amber-200"></div>
            </div>
            <div>
              <div class="text-[10px] text-slate-500 mb-1">æ™‚</div>
              <div id="hG" class="bazi-char"></div>
              <div id="hZ" class="text-sm text-slate-300"></div>
            </div>
          </div>
          <div id="meta" class="text-[11px] text-slate-500 mt-2"></div>
        </div>

        <!-- äº”è¡Œå„€è¡¨æ¿ -->
        <div class="glass p-6 space-y-4">
          <h3 class="text-sm font-bold text-slate-300 tracking-[0.25em] uppercase">
            äº”è¡Œèƒ½é‡å„€è¡¨æ¿
          </h3>

          <div>
            <div class="text-[11px] text-slate-400 mb-1">è¡¨å±¤ Â· å¤©å¹²çµæ§‹</div>
            <div id="surfaceWx" class="space-y-1.5"></div>
          </div>

          <div>
            <div class="text-[11px] text-slate-400 mb-1">å¯¦æˆ° Â· è—å¹²ï¼‹æœˆä»¤åŠ æ¬Š</div>
            <div id="strategicWx" class="space-y-1.5"></div>
          </div>
        </div>
      </div>

      <!-- ç´«å¾®å‘½ç›¤ 12å®® -->
      <div class="glass p-6 space-y-4">
        <div class="flex items-center justify-between">
          <h3 class="text-sm font-bold text-slate-300 tracking-[0.25em] uppercase">
            ç´«å¾® Â· å‘½ç›¤ 12 å®®ç¸½è¦½
          </h3>
          <span class="text-[11px] text-slate-500">
            å‘½å®®ï¼å®˜ç¥¿å®®ï¼è²¡å¸›å®® ç‚ºä¸»è»¸è§€å¯Ÿ
          </span>
        </div>

        <div id="ziweiGrid" class="zw-grid-container">
          <!-- JS æœƒå¡é€²ä¾† -->
        </div>
      </div>

      <!-- æµæœˆç¯€å¥ -->
      <div class="glass p-6 space-y-3">
        <h3 class="text-sm font-bold text-slate-300 tracking-[0.25em] uppercase">
          2026 æµæœˆç¯€å¥ Â· ç´…ç¶ ç‡ˆ
        </h3>
        <div id="monthGrid" class="space-y-2"></div>
        <p class="text-[11px] text-slate-500">
          â€» æ¡ç¯€æ°£æœˆå€é–“ï¼ˆä¾‹ï¼šåºšå¯… 02.04-03.05ï¼‰ï¼Œç´…ç‡ˆæœˆå…ˆå®ˆè¦å‰‡ï¼Œç¶ ç‡ˆæœˆç©©ç©©æ¨é€²ã€‚
        </p>
      </div>

      <!-- æˆ°ç•¥è§£è®€ -->
      <div class="glass p-6 space-y-3">
        <h3 class="text-sm font-bold text-slate-300 tracking-[0.25em] uppercase">
          æˆ°ç•¥è§£è®€ Â· ä½ çš„äººç”Ÿä½¿ç”¨èªªæ˜æ›¸ï¼ˆç²¾ç°¡ç‰ˆï¼‰
        </h3>
        <div id="analysisBox" class="space-y-2 text-sm text-slate-200"></div>
      </div>

      <!-- è«®è©¢ CTA -->
      <div id="consult" class="glass p-6 space-y-3 border border-amber-400/40">
        <h3 class="text-lg font-black text-amber-300">
          æƒ³æŠŠé€™ä»½æˆ°ç•¥åœ–ï¼Œè®Šæˆä½ çš„ 50 é äººç”Ÿä½¿ç”¨èªªæ˜æ›¸ï¼Ÿ
        </h3>
        <p class="text-sm text-slate-200 leading-relaxed">
          å¦‚æœä½ å¸Œæœ›æˆ‘æŠŠä½ çš„å‘½æ ¼çµ„æˆã€äººç”Ÿå¤§é‹ã€æµå¹´æµæœˆã€ç”Ÿæ¶¯è¦åŠƒå’Œæœ€é©åˆè‡ªå·±çš„äººç”Ÿç¯€å¥
          åšæˆå¯ä¿ç”¨ä¸€ç”Ÿçš„ 50 é äººç”Ÿä½¿ç”¨èªªæ˜æ›¸ï¼Œæ­¡è¿é ç´„ç·šä¸Šè«®è©¢ã€‚
        </p>
        <a
          href="https://forms.gle/UVCSq1udEC549gzYA"
          target="_blank"
          class="inline-flex items-center justify-center px-4 py-3 rounded-xl bg-gradient-to-r from-amber-400 to-yellow-500 text-slate-950 text-sm font-black tracking-widest hover:brightness-110 active:scale-[0.99] transition"
        >
          å‰å¾€é ç´„èˆ‡æä¼¯å½¥è€å¸«è«®è©¢
        </a>
      </div>
    </section>
  </main>

  <script>
    const API_BASE = "https://17gonplay-api.billeetw.workers.dev";

    /* ========= äº”è¡Œ bar ========= */
    function renderBar(id, data, max) {
      const box = document.getElementById(id);
      if (!box) return;
      box.innerHTML = "";
      ["æœ¨","ç«","åœŸ","é‡‘","æ°´"].forEach(e => {
        const v = Number(data?.[e] || 0);
        const w = max ? Math.max(4, (v / max) * 100) : 0;
        box.innerHTML += `
          <div class="mb-1">
            <div class="flex justify-between text-[11px]">
              <span>${e}</span>
              <span>${v.toFixed(1)}</span>
            </div>
            <div class="h-1.5 bg-slate-800 rounded-full overflow-hidden">
              <div class="h-full wuxing-${e}" style="width:${w}%"></div>
            </div>
          </div>
        `;
      });
    }

    /* ========= ç´«å¾®æ–¹ç›¤ ========== */

    const PALACE_ORDER = ["å‘½å®®","å…„å¼Ÿ","å¤«å¦»","å­å¥³","è²¡å¸›","ç–¾å„","é·ç§»","åƒ•å½¹","å®˜ç¥¿","ç”°å®…","ç¦å¾·","çˆ¶æ¯"];
    const gridAreas = [
      "1/1/2/2","1/2/2/3","1/3/2/4","1/4/2/5", // ä¸Šæ’ 4 æ ¼
      "2/4/3/5","3/4/4/5","4/4/5/5",          // å³å´ 3 æ ¼
      "4/3/5/4","4/2/5/3","4/1/5/2",          // ä¸‹æ’ 3 æ ¼
      "3/1/4/2","2/1/3/2"                     // å·¦å´ 2 æ ¼
    ];

    // ä¸»æ˜Ÿäº”è¡Œï¼ˆç°¡åŒ–ç‰ˆï¼Œå¯ä¹‹å¾Œæ“´å……ï¼‰
    const STAR_WUXING_MAP = {
      "ç´«å¾®":"åœŸ","å¤©æ©Ÿ":"æœ¨","å¤ªé™½":"ç«","æ­¦æ›²":"é‡‘","å¤©åŒ":"æ°´",
      "å»‰è²":"ç«","å¤©åºœ":"åœŸ","å¤ªé™°":"æ°´","è²ªç‹¼":"æœ¨",
      "å·¨é–€":"æ°´","å¤©ç›¸":"æ°´","å¤©æ¢":"åœŸ","ä¸ƒæ®º":"é‡‘","ç ´è»":"æ°´"
    };

    function renderZiwei(ziwei) {
      const container = document.getElementById("ziweiGrid");
      if (!container) return;

      // æ²’è³‡æ–™æ™‚é¡¯ç¤ºæç¤º
      if (!ziwei) {
        container.className = "zw-grid-container";
        container.innerHTML = `
          <div class="col-span-4 flex items-center justify-center text-xs text-slate-500">
            ï¼ˆç›®å‰å°šæœªå–å¾—ç´«å¾®è³‡æ–™ï¼Œä¹‹å¾Œå¯æ¥ iztro å®Œæ•´å‘½ç›¤ï¼‰
          </div>
        `;
        return;
      }

      const mainStarsData = ziwei.mainStars || {};

      container.className = "zw-grid-container";
      container.innerHTML = "";

      PALACE_ORDER.forEach((name, idx) => {
        const starsList = mainStarsData[name] || [];
        const isKey = ["å‘½å®®","å®˜ç¥¿","è²¡å¸›"].includes(name);

        let starsHtml = "";
        let palaceMainElement = "";

        if (starsList.length > 0) {
          starsHtml = starsList.map((starName, i) => {
            const wx = STAR_WUXING_MAP[starName] || "";
            if (i === 0 && wx) palaceMainElement = wx;
            return `<span class="${wx ? "star-wx-" + wx : ""}">${starName}</span>`;
          }).join("<br>");
        } else {
          starsHtml = '<span class="text-slate-600 text-xs italic font-normal">ç©ºå®®</span>';
        }

        const glowClass = palaceMainElement ? `palace-glow-${palaceMainElement}` : "";

        container.innerHTML += `
          <div class="zw-palace ${isKey ? "zw-palace-key" : ""} ${glowClass}"
               style="grid-area:${gridAreas[idx]}">
            <div class="text-[10px] font-bold text-slate-500 mb-1">${name}</div>
            <div class="text-[13px] font-black leading-snug tracking-wide">
              ${starsHtml}
            </div>
          </div>
        `;
      });

      container.innerHTML += `
        <div class="zw-center-block">
          <div class="zw-center-block-badge mb-1">Destiny Core</div>
          <div class="text-amber-400 font-black text-xl tracking-widest">
            ${ziwei.core?.minggong || "â€”"}
          </div>
          <div class="text-[11px] text-slate-400 mt-2">
            èº«å®®ï¼š${ziwei.core?.shengong || "â€”"}
          </div>
          <div class="text-[11px] text-slate-400 mt-1">
            ${ziwei.core?.wuxingju || "â€”"}å±€
          </div>
        </div>
      `;
    }

    /* ========= ä¸»æµç¨‹ï¼šåªæ‰“ /compute/all ========= */

    async function calculate() {
      const vy   = Number(document.getElementById("birthYear").value);
      const vm   = Number(document.getElementById("birthMonth").value);
      const vd   = Number(document.getElementById("birthDay").value);
      const vh   = Number(document.getElementById("birthHour").value);
      const vmin = Number(document.getElementById("birthMinute").value);

      try {
        if (![vy,vm,vd,vh,vmin].every(n => Number.isFinite(n))) {
          throw new Error("è«‹å…ˆé¸å¥½å‡ºç”Ÿå¹´æœˆæ—¥èˆ‡æ™‚é–“");
        }

        const resp = await fetch(`${API_BASE}/compute/all`, {
          method: "POST",
          headers: { "Content-Type":"application/json" },
          body: JSON.stringify({ year: vy, month: vm, day: vd, hour: vh, minute: vmin })
        });

        if (!resp.ok) {
          const txt = await resp.text().catch(() => "");
          throw new Error(`API HTTP ${resp.status} ${txt || ""}`);
        }

        const payload = await resp.json();

        // debug ç”¨
        window.__payload = payload;
        window.__contract = payload?.features;

        if (!payload?.ok) throw new Error(payload?.error || "API error");

        const contract = payload.features || {};
        const bazi = contract.bazi;
        const ziwei = contract.ziwei;

        if (!bazi) throw new Error("contract.bazi ä¸å­˜åœ¨");

        // å››æŸ±é¡¯ç¤º
        const disp = bazi.display || {};
        document.getElementById("yG").innerText = disp.yG || "";
        document.getElementById("yZ").innerText = disp.yZ || "";
        document.getElementById("mG").innerText = disp.mG || "";
        document.getElementById("mZ").innerText = disp.mZ || "";
        document.getElementById("dG").innerText = disp.dG || "";
        document.getElementById("dZ").innerText = disp.dZ || "";
        document.getElementById("hG").innerText = disp.hG || "";
        document.getElementById("hZ").innerText = disp.hZ || "";

        // äº”è¡Œ
        renderBar("surfaceWx", bazi.wuxing?.surface, 4);
        renderBar("strategicWx", bazi.wuxing?.strategic, bazi.wuxing?.maxStrategic || 1);

        // æµæœˆ
        const bounds = bazi.liuyue2026?.bounds || [];
        const monthGrid = document.getElementById("monthGrid");
        monthGrid.innerHTML = "";

        const redMonths = [];

        if (bounds.length) {
          bounds.forEach(b => {
            const isRed = b.light === "RED";
            if (isRed) redMonths.push(b.gz);

            monthGrid.innerHTML += `
              <div class="flex items-center justify-between p-3 rounded-xl border-l-4 ${isRed ? "border-red-500 bg-red-500/10" : "border-emerald-400 bg-emerald-500/10"}">
                <div>
                  <div class="text-sm font-bold">
                    ${b.gz}
                    <span class="text-[11px] text-slate-300 ml-1">${b.range || ""}</span>
                  </div>
                  <div class="text-[11px] text-slate-900/80 mt-0.5">
                    æœ¬æ°£ï¼š${b.ssBranch || "â€”"}
                  </div>
                </div>
                <div class="text-[11px] font-bold px-2 py-1 rounded-lg bg-slate-900/80 text-slate-50">
                  ${isRed ? "ğŸ”´ å£“åŠ›" : "ğŸŸ¢ ç©©é€²"}
                </div>
              </div>
            `;
          });
        } else {
          monthGrid.innerHTML = `<div class="text-xs text-slate-400 italic">ï¼ˆå°šæœªå–å¾—æµæœˆè³‡æ–™ï¼‰</div>`;
        }

        // æˆ°ç•¥è§£è®€ï¼ˆç°¡ç‰ˆ fallbackï¼‰
        const analysisBox = document.getElementById("analysisBox");
        const dominant = (bazi.tenGod?.dominant || "").trim() || "æœªå®š";
        const dmElement = bazi.dmElement || "ç«";

        const redText = redMonths.length
          ? `å£“åŠ›æœˆï¼š${redMonths.join("ã€")}ï¼ˆé€™äº›æœˆå„ªå…ˆå®ˆè¦å‰‡ï¼Œä¸è¦ç¡¬è¡ï¼‰ã€‚`
          : "ä»Šå¹´å£“åŠ›æœˆåå°‘ï¼Œå¯ä»¥ç©©ç©©æ¨é€²ã€‚";

        analysisBox.innerHTML = `
          <p>ä½ çš„æ—¥ä¸»äº”è¡Œä¸»å ´æ˜¯ã€Œ${dmElement}ã€ï¼Œ2026 å¹´åº¦ä¸»è»¸åå‘ã€Œ${dominant}ã€ã€‚</p>
          <p>${redText}</p>
          <p>ç­–ç•¥ï¼šæŠŠæˆ°ç·šè®Šå°‘ã€æµç¨‹è®Šç©©ï¼ŒæŠŠä½ æœ€é †æ‰‹çš„é‚£ä¸€ç¨®åšäº‹æ–¹å¼ï¼Œè®Šæˆå›ºå®šç¯€å¥ã€‚</p>
          <p class="text-[11px] text-slate-400 mt-2">
            ï¼ˆä¹‹å¾Œå¯æ¥ /render/reportï¼Œæ”¹æˆå®Œæ•´ AI æ•˜äº‹ç‰ˆï¼‰
          </p>
        `;

        // ç´«å¾®å‘½ç›¤
        renderZiwei(ziwei);

        // é¡¯ç¤ºå ±å‘Šå€
        document.getElementById("report").classList.remove("hidden");
        document.getElementById("report").scrollIntoView({ behavior:"smooth", block:"start" });

      } catch (e) {
        console.error(e);
        alert("è¨ˆç®—å¤±æ•—ï¼š" + (e?.message || e));
      }
    }

    /* ========= æ—¥æœŸé¸å–® init ========= */
    function initSelectors() {
      const y   = document.getElementById("birthYear");
      const m   = document.getElementById("birthMonth");
      const d   = document.getElementById("birthDay");
      const h   = document.getElementById("birthHour");
      const min = document.getElementById("birthMinute");

      if (!y || !m || !d || !h || !min) return;

      for (let i = 2026; i >= 1940; i--) {
        y.add(new Option(i + " å¹´", i));
      }
      for (let i = 1; i <= 12; i++) {
        m.add(new Option(i + " æœˆ", i));
      }
      for (let i = 0; i < 24; i++) {
        const label = String(i).padStart(2,"0") + " æ™‚";
        h.add(new Option(label, i));
      }
      ["00","15","30","45"].forEach(v => {
        min.add(new Option(v + " åˆ†", v));
      });

      y.value   = "1990";
      m.value   = "1";
      h.value   = "12";
      min.value = "00";

      updateDays();
      m.addEventListener("change", updateDays);
      y.addEventListener("change", updateDays);
    }

    function updateDays() {
      const y = document.getElementById("birthYear");
      const m = document.getElementById("birthMonth");
      const d = document.getElementById("birthDay");
      if (!y || !m || !d) return;

      const year  = Number(y.value);
      const month = Number(m.value);
      const cur   = d.value;

      d.innerHTML = "";
      const days = new Date(year, month, 0).getDate();
      for (let i = 1; i <= days; i++) {
        const opt = new Option(i + " æ—¥", i);
        if (String(i) === String(cur) || (!cur && i === 1)) opt.selected = true;
        d.add(opt);
      }
    }

    document.addEventListener("DOMContentLoaded", initSelectors);
  </script>
</body>
</html>



