<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2026 æˆ°ç•¥å°èˆªï½œä¸€èµ·å‡ºä¾†ç©</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

  <style>
    body { background:#0b0e14; color:#e2e8f0; font-family: system-ui,-apple-system; }
    .glass { background: rgba(255,255,255,.04); backdrop-filter: blur(10px); border:1px solid rgba(255,255,255,.08); }
    .bazi-char { font-size:1.8rem; font-weight:900; }
    .wuxing-æœ¨{background:#2ecc71}.wuxing-ç«{background:#e74c3c}
    .wuxing-åœŸ{background:#f1c40f}.wuxing-é‡‘{background:#ced4da}
    .wuxing-æ°´{background:#3498db}
  </style>
</head>

<body class="p-4">

<h1 class="text-3xl font-black text-center mb-6">2026 æµå¹´æˆ°ç•¥å ±å‘Š</h1>

<!-- è¼¸å…¥ -->
<div class="glass p-6 rounded-xl max-w-xl mx-auto mb-10">
  <div class="grid grid-cols-3 gap-2 mb-3">
    <select id="birthYear" class="bg-black/40 p-2 rounded"></select>
    <select id="birthMonth" class="bg-black/40 p-2 rounded" onchange="updateDays()"></select>
    <select id="birthDay" class="bg-black/40 p-2 rounded"></select>
  </div>
  <div class="grid grid-cols-2 gap-2 mb-4">
    <select id="birthHour" class="bg-black/40 p-2 rounded"></select>
    <select id="birthMinute" class="bg-black/40 p-2 rounded"></select>
  </div>
  <button onclick="launch()" class="w-full bg-amber-500 text-black py-3 rounded font-black">
    ç”Ÿæˆæˆ‘çš„ 2026 æˆ°ç•¥
  </button>
</div>

<!-- å ±å‘Š -->
<div id="report" class="hidden max-w-xl mx-auto space-y-10">

  <!-- å››æŸ± -->
  <div class="glass p-6 rounded-xl">
    <div class="grid grid-cols-4 text-center">
      <div><div id="yG" class="bazi-char"></div><div id="yZ"></div></div>
      <div><div id="mG" class="bazi-char"></div><div id="mZ"></div></div>
      <div><div id="dG" class="bazi-char text-amber-400"></div><div id="dZ"></div></div>
      <div><div id="hG" class="bazi-char"></div><div id="hZ"></div></div>
    </div>
  </div>

  <!-- äº”è¡Œ -->
  <div class="glass p-6 rounded-xl">
    <h2 class="font-black mb-3">äº”è¡Œèƒ½é‡</h2>
    <div id="surfaceWx" class="space-y-2 mb-4"></div>
    <div id="strategicWx" class="space-y-2"></div>
  </div>

  <!-- æµæœˆ -->
  <div class="glass p-6 rounded-xl">
    <h2 class="font-black mb-3">2026 æµæœˆç¯€å¥</h2>
    <div id="monthGrid" class="space-y-2"></div>
  </div>

  <!-- åˆ†æ -->
  <div class="glass p-6 rounded-xl">
    <h2 class="font-black mb-3">æˆ°ç•¥è§£è®€</h2>
    <div id="analysisBox" class="space-y-2"></div>
  </div>

</div>

<script>
/* ========= åŸºæœ¬è¨­å®š ========= */
const API_BASE = "https://17gonplay-api.billeetw.workers.dev";

/* ========= å·¥å…· ========= */
function renderBar(id, data, max){
  const box = document.getElementById(id);
  box.innerHTML="";
  ["æœ¨","ç«","åœŸ","é‡‘","æ°´"].forEach(e=>{
    const v=Number(data[e]||0);
    const w=max?Math.max(2,(v/max)*100):0;
    box.innerHTML+=`
      <div>
        <div class="flex justify-between text-xs"><span>${e}</span><span>${v.toFixed(1)}</span></div>
        <div class="h-2 bg-white/10 rounded">
          <div class="h-full wuxing-${e}" style="width:${w}%"></div>
        </div>
      </div>`;
  });
}

/* ========= ä¸»æµç¨‹ ========= */
async function calculate(){
  const vy=+birthYear.value, vm=+birthMonth.value, vd=+birthDay.value;
  const vh=+birthHour.value, vmin=+birthMinute.value;

  const resp = await fetch(`${API_BASE}/compute/bazi`,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({year:vy,month:vm,day:vd,hour:vh,minute:vmin})
  });
  const data = await resp.json();
  if(!data.ok) throw new Error(data.error);

  /* å››æŸ± */
  yG.innerText=data.pillars.year[0]; yZ.innerText=data.pillars.year[1];
  mG.innerText=data.pillars.month[0]; mZ.innerText=data.pillars.month[1];
  dG.innerText=data.pillars.day[0]; dZ.innerText=data.pillars.day[1];
  hG.innerText=data.pillars.time[0]; hZ.innerText=data.pillars.time[1];

  /* äº”è¡Œ */
  renderBar("surfaceWx",data.features.wuxing.surface,4);
  renderBar("strategicWx",data.features.wuxing.strategic,data.features.wuxing.maxStrategic);

  /* æµæœˆ */
  monthGrid.innerHTML="";
  data.features.liuyue2026.bounds.forEach(b=>{
    const red=b.light==="RED";
    monthGrid.innerHTML+=`
      <div class="p-3 rounded border-l-4 ${red?"border-red-500":"border-emerald-500"} bg-black/20">
        <div class="font-bold">${b.gz} <span class="text-xs text-slate-400">${b.range}</span></div>
        <div class="text-xs">${red?"ğŸ”´ å£“åŠ›":"ğŸŸ¢ ç©©é€²"}ï½œ${b.ssBranch}</div>
      </div>`;
  });

  /* åˆ†æï¼ˆç©©å®š fallbackï¼‰ */
  const redMonths=data.features.liuyue2026.bounds.filter(x=>x.light==="RED").map(x=>x.gz);
  analysisBox.innerHTML=`
    <p>ä½ çš„ä¸»è»¸åç¥æ˜¯ã€Œ${data.features.tenGod.dominant}ã€ã€‚</p>
    <p>2026 é—œéµåœ¨ã€Œå…ˆç«‹è¦å‰‡ï¼Œå†æ¨é€²ã€ã€‚</p>
    <p>å£“åŠ›æœˆï¼š${redMonths.join("ã€")||"ç„¡"}ã€‚</p>
    <p>ç­–ç•¥ï¼šæ¸›å°‘åŒæ™‚æ¨é€²çš„æˆ°ç·šï¼ŒæŠŠç¯€å¥å›ºå®šã€‚</p>`;

  report.classList.remove("hidden");
}

/* ========= UI ========= */
function launch(){ calculate().catch(e=>alert(e.message)); }

function initSelectors(){
  for(let i=2026;i>=1940;i--) birthYear.add(new Option(i,i));
  for(let i=1;i<=12;i++) birthMonth.add(new Option(i,i));
  for(let i=0;i<24;i++) birthHour.add(new Option(i,i));
  ["00","15","30","45"].forEach(v=>birthMinute.add(new Option(v,v)));
  birthYear.value=1990; birthMonth.value=1; birthHour.value=12;
  updateDays();
}
function updateDays(){
  birthDay.innerHTML="";
  const d=new Date(birthYear.value,birthMonth.value,0).getDate();
  for(let i=1;i<=d;i++) birthDay.add(new Option(i,i));
}
document.addEventListener("DOMContentLoaded",initSelectors);
</script>
</body>
</html>
















