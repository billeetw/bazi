# Phase 1.1: å››åŒ–ç³»çµ±å®Œæ•´åŒ– - æ•´åˆå®Œæˆå ±å‘Š

## âœ… æ•´åˆå®Œæˆ

### 1. æ ¸å¿ƒæ¨¡çµ„å‰µå»º
- âœ… `js/calc/fourTransformations.js` - å®Œæ•´å››åŒ–ç³»çµ±æ¨¡çµ„
- âœ… å¯¦ç¾æœ¬å‘½ã€å¤§é™ã€æµå¹´ã€å°é™å››å±¤å››åŒ–è¨ˆç®—
- âœ… å¯¦ç¾æµå¹´å¤©å¹²åœ°æ”¯è¨ˆç®—
- âœ… å¯¦ç¾å¤§é™å¤©å¹²å’Œå®®ä½è¨ˆç®—

### 2. Pipeline æ•´åˆ
- âœ… æ›´æ–° `js/calc/ziweiPipeline.js` çš„ `stageSiHua` å‡½æ•¸
- âœ… æ”¯æŒå®Œæ•´å››åŒ–ç³»çµ±ï¼ˆæœ¬å‘½ã€å¤§é™ã€æµå¹´ã€å°é™ï¼‰
- âœ… ä¿æŒå‘å¾Œå…¼å®¹ï¼ˆå¦‚æœæ²’æœ‰å®Œæ•´å››åŒ–è³‡æ–™ï¼Œä½¿ç”¨å°é™å››åŒ–ï¼‰

### 3. ä¸»è¨ˆç®—å‡½æ•¸æ•´åˆ
- âœ… æ›´æ–° `js/calc.js` çš„ `computeAllPalaceScores` å‡½æ•¸
- âœ… æ·»åŠ å¯é¸åƒæ•¸ `options: { bazi, age, currentYear }`
- âœ… è‡ªå‹•è¨ˆç®—å®Œæ•´å››åŒ–ç³»çµ±ï¼ˆå¦‚æœæä¾›äº† bazi å’Œ ageï¼‰
- âœ… å°‡å››åŒ–è³‡æ–™å‚³éçµ¦ Pipeline

### 4. UI å±¤æ•´åˆ
- âœ… æ›´æ–° `js/ui/services/data-renderer.js` - å‚³é bazi å’Œ age
- âœ… æ›´æ–° `js/ui.js` - å‚³é bazi å’Œ age
- âœ… æ›´æ–° `js/ui/services/event-bindings.js` - å‚³é bazi å’Œ age

### 5. HTML æ•´åˆ
- âœ… æ›´æ–° `index.html` - æ·»åŠ  `fourTransformations.js` è…³æœ¬å¼•ç”¨

## ğŸ“‹ å››åŒ–æ¬Šé‡åˆ†é…

| å››åŒ–å±¤ç´š | æ¬Šé‡ | å½±éŸ¿ç¯„åœ | èªªæ˜ |
|---------|------|---------|------|
| æœ¬å‘½å››åŒ– | 1.0 | çµ‚èº« | åŸºæ–¼ç”Ÿå¹´å¤©å¹²ï¼ŒåŸºç¤å½±éŸ¿ |
| å¤§é™å››åŒ– | 0.8 | 10å¹´ | åŸºæ–¼å¤§é™å¤©å¹²ï¼Œä¸­æœŸå½±éŸ¿ |
| æµå¹´å››åŒ– | 0.6 | 1å¹´ | åŸºæ–¼æµå¹´å¤©å¹²ï¼Œå¹´åº¦å½±éŸ¿ |
| å°é™å››åŒ– | 0.4 | å€‹äººåŒ–å¹´åº¦ | åŸºæ–¼å°é™å¤©å¹²ï¼Œå€‹äººåŒ–å½±éŸ¿ |

## ğŸ”„ ä½¿ç”¨æ–¹å¼

### è‡ªå‹•æ¨¡å¼ï¼ˆæ¨è–¦ï¼‰
```javascript
// ç³»çµ±æœƒè‡ªå‹•è¨ˆç®—å®Œæ•´å››åŒ–ï¼ˆå¦‚æœæä¾›äº† bazi å’Œ ageï¼‰
computeAllPalaceScores(ziwei, horoscope, { bazi, age })
```

### æ‰‹å‹•æ¨¡å¼
```javascript
// æ‰‹å‹•è¨ˆç®—å®Œæ•´å››åŒ–ç³»çµ±
const fourTransformations = window.FourTransformations.computeFourTransformations({
  bazi: baziData,
  ziwei: ziweiData,
  horoscope: horoscopeData,
  age: 30,
  currentYear: 2026
});

// å‚³éçµ¦è¨ˆç®—å‡½æ•¸
computeAllPalaceScores(ziwei, horoscope, { 
  bazi, 
  age, 
  fourTransformations 
})
```

## ğŸ“Š æ•¸æ“šçµæ§‹

### å®Œæ•´å››åŒ–ç³»çµ±è¿”å›çµæ§‹
```javascript
{
  benming: {
    stem: "ç”²",
    mutagenStars: { ç¥¿: "å»‰è²", æ¬Š: "ç ´è»", ç§‘: "æ­¦æ›²", å¿Œ: "å¤ªé™½" },
    weights: { "å»‰è²": 3, "ç ´è»": 2, "æ­¦æ›²": 1, "å¤ªé™½": -3 },
    type: 'benming'
  },
  dalimit: {
    stem: "ä¹™",
    palace: "å…„å¼Ÿ",
    mutagenStars: { ... },
    weights: { ... },
    type: 'dalimit'
  },
  liunian: {
    stem: "ä¸™",
    branch: "å¯…",
    palace: "å‘½å®®",
    mutagenStars: { ... },
    weights: { ... },
    type: 'liunian'
  },
  xiaoxian: {
    stem: "ä¸",
    palace: "å¤«å¦»",
    mutagenStars: { ... },
    weights: { ... },
    type: 'xiaoxian'
  },
  combinedWeights: {
    "å»‰è²": 3.0,
    "ç ´è»": 2.0,
    // ... åˆä½µå¾Œçš„æ¬Šé‡
  },
  summary: {
    benmingStem: "ç”²",
    dalimitStem: "ä¹™",
    dalimitPalace: "å…„å¼Ÿ",
    liunianStem: "ä¸™",
    liunianBranch: "å¯…",
    liunianPalace: "å‘½å®®",
    xiaoxianStem: "ä¸",
    xiaoxianPalace: "å¤«å¦»"
  }
}
```

## âš ï¸ å‘å¾Œå…¼å®¹

- âœ… å¦‚æœæ²’æœ‰æä¾› `bazi` æˆ– `age`ï¼Œç³»çµ±æœƒå›é€€åˆ°åƒ…ä½¿ç”¨å°é™å››åŒ–
- âœ… èˆŠçš„èª¿ç”¨æ–¹å¼ `computeAllPalaceScores(ziwei, horoscope)` ä»ç„¶æœ‰æ•ˆ
- âœ… ä¸æœƒç ´å£ç¾æœ‰åŠŸèƒ½

## ğŸ§ª æ¸¬è©¦å»ºè­°

1. **åŸºæœ¬æ¸¬è©¦**ï¼šå®Œæˆè¨ˆç®—ï¼Œæª¢æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰å››åŒ–è¨ˆç®—æ—¥èªŒ
2. **å¹´é½¡è®ŠåŒ–æ¸¬è©¦**ï¼šèª¿æ•´å¹´é½¡æ»‘æ¡¿ï¼Œè§€å¯Ÿå››åŒ–è®ŠåŒ–
3. **å¤§é™æ¸¬è©¦**ï¼šæ¸¬è©¦ä¸åŒå¹´é½¡æ®µçš„å¤§é™å››åŒ–æ˜¯å¦æ­£ç¢º
4. **æµå¹´æ¸¬è©¦**ï¼šé©—è­‰æµå¹´å››åŒ–æ˜¯å¦æ­£ç¢ºï¼ˆ2026å¹´ï¼‰

## ğŸ“ ä¸‹ä¸€æ­¥

1. âœ… æ•´åˆå®Œæˆ
2. â³ æ¸¬è©¦é©—è­‰
3. â³ UI é¡¯ç¤ºå››åŒ–è³‡è¨Šï¼ˆå¯é¸ï¼‰
4. â³ æ–‡æª”æ›´æ–°

